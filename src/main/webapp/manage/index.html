<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta name="description" content="Xenon Boostrap Admin Panel" />
	<meta name="author" content="" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arimo:400,700,400italic">
	<link rel="stylesheet" href="../js/assets/css/fonts/linecons/css/linecons.css">
	<link rel="stylesheet" href="../js/assets/css/fonts/fontawesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="../js/assets/css/bootstrap.css">
	<link rel="stylesheet" href="../js/assets/css/xenon-core.css">
	<link rel="stylesheet" href="../js/assets/css/xenon-forms.css">
	<link rel="stylesheet" href="../js/assets/css/xenon-components.css">
	<link rel="stylesheet" href="../js/assets/css/xenon-skins.css">
	<link rel="stylesheet" href="../js/assets/css/custom.css">
	<link rel="stylesheet" href="../js/bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" href="../js/bootstrapvalidator/css/bootstrapValidator.css">  
	

	<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
	
	
</head>
<body class="page-body">
	<div class="settings-pane">
		<a href="#" data-toggle="settings-pane" data-animate="true">
			&times;
		</a>
		<!-- head -->
		<div class="settings-pane-inner">
			<div class="row">
				<div class="col-md-4">
					<div class="user-info">
						<div class="user-image">
							<a href="extra-profile.html">
								<img src="../js/assets/images/user.jpeg" class="img-responsive img-circle" />
							</a>
						</div>
						<div class="user-details">
							<h3>
								<a href="#" id="loginName">XJL</a>
								<!-- Available statuses: is-online, is-idle, is-busy and is-offline -->
								<span class="user-status is-online"></span>
							</h3>
							<p class="user-title">角色：互联网+政务服务</p>
							<div class="user-links">
								<a href="#" class="btn btn-primary">编辑</a>
								<a href="#" class="btn btn-success">个人信息</a>
							</div>
						</div>
					</div>
				</div>
				<!-- 信息 -->
				<div class="col-md-8 link-blocks-env">
					<div class="links-block left-sep">
						<h4>
							<span>通知通告</span>
						</h4>
						<ul class="list-unstyled">
							<li>
								<input type="checkbox" class="cbr cbr-primary" checked="checked" id="sp-chk1" />
								<label for="sp-chk1"></label>
							</li>
							<li>
								<input type="checkbox" class="cbr cbr-primary" checked="checked" id="sp-chk2" />
								<label for="sp-chk2"></label>
							</li>
							<li>
								<input type="checkbox" class="cbr cbr-primary" checked="checked" id="sp-chk3" />
								<label for="sp-chk3"></label>
							</li>
							<li>
								<input type="checkbox" class="cbr cbr-primary" checked="checked" id="sp-chk4" />
								<label for="sp-chk4"></label>
							</li>
						</ul>
					</div>
					<!-- 求助台 -->
					<div class="links-block left-sep">
						<h4>
							<a href="#">
								<span>帮助</span>
							</a>
						</h4>
						<ul class="list-unstyled">
							<li>
								<a href="#">
									<i class="fa-angle-right"></i>
								</a>
							</li>
							<li>
								<a href="#">
									<i class="fa-angle-right"></i>
								</a>
							</li>
							<li>
								<a href="#">
									<i class="fa-angle-right"></i>
								</a>
							</li>
							<li>
								<a href="#">
									<i class="fa-angle-right"></i>
								</a>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<div class="page-container"><!-- add class "sidebar-collapsed" to close sidebar by default, "chat-visible" to make chat appear always -->
			
		<!-- Add "fixed" class to make the sidebar fixed always to the browser viewport. -->
		<!-- Adding class "toggle-others" will keep only one menu item open at a time. -->
		<!-- Adding class "collapsed" collapse sidebar root elements and show only icons. -->
		<div class="sidebar-menu toggle-others fixed">
			<div class="sidebar-menu-inner">	
				<header class="logo-env">
					<!-- logo -->
					<div class="logo">
						<a href="#" class="logo-expanded">
							<img src="../js/assets/images/logo@2x.png" width="130" alt="" />
						</a>
					</div>
					
					<!-- This will toggle the mobile menu and will be visible only on mobile devices -->
					<div class="mobile-menu-toggle visible-xs">
						<a href="#" data-toggle="user-info-menu">
							<i class="fa-bell-o"></i>
							<span class="badge badge-success"></span>
						</a>
						<a href="#" data-toggle="mobile-menu">
							<i class="fa-bars"></i>
						</a>
					</div>
					<!-- This will open the popup with user profile settings, you can use for any purpose, just be creative -->
					<div class="settings-icon">
						<a href="#" data-toggle="settings-pane" data-animate="true">
							<i class="linecons-cog"></i>
						</a>
					</div>
				</header>
				<ul id="main-menu" class="main-menu">
					<!-- add class "multiple-expanded" to allow multiple submenus to open -->
					<!-- class "auto-inherit-active-class" will automatically add "active" class for parent elements who are marked already with class "active" -->
					<li class="active opened active">
						<a href="dashboard-1.html">
							<i class="linecons-cog"></i>
							<span class="title">系统设置</span>
						</a>
						<ul>
							<li >
								<a id="system_html" href="#" onclick="javascript:switchModel('http://123.57.4.104:9998/springmvc_hello/showUploaded.do','system_html');">
									<span class="title">发布原型</span>
								</a>
							</li>
							<li >
								<a id="system_dict" href="#" onclick="javascript:switchModel('../dict/dict.html?selectFlag=true&editFlag=true','system_html');">
									<span class="title">系统字典</span>
								</a>
							</li>
							<li>
								<a href="skin-generator.html">
									<span class="title">系统皮肤</span> 
								</a>
							</li>
						</ul>
					</li>
				</ul>
			</div>
		</div>
		<!-- 主页面 -->
		<div class="main-content">
			<!-- User Info, Notifications and Menu Bar -->
			<nav class="navbar user-info-navbar" role="navigation">
				<!-- Left links for user info navbar -->
				<ul class="user-info-menu left-links list-inline list-unstyled">
					<li class="hidden-sm hidden-xs">
						<a href="#" data-toggle="sidebar">
							<i class="fa-bars"></i>
						</a>
					</li>
					<!-- 消息提示 -->
					<li class="dropdown hover-line">
						<a href="#" data-toggle="dropdown">
							<i class="fa-bell-o"></i>
							<span class="badge badge-purple">0</span>
						</a>
						<ul class="dropdown-menu notifications">
							<li class="external">
								<a href="#">
									<span>View all notifications</span>
									<i class="fa-link-ext"></i>
								</a>
							</li>
						</ul>
					</li>
				</ul>
				<!-- 检索框 -->
				<!-- Right links for user info navbar -->
				<ul class="user-info-menu right-links list-inline list-unstyled">
					<li class="search-form"><!-- You can add "always-visible" to show make the search input visible -->
						<form method="get" action="extra-search.html">
							<input type="text" name="s" class="form-control search-field" placeholder="Type to search..." />
							<button type="submit" class="btn btn-link">
								<i class="linecons-search"></i>
							</button>
						</form>
					</li>
					<li class="dropdown user-profile">
						<a href="#" data-toggle="dropdown">
							<img src="../js/assets/images/user.jpeg" alt="user-image" class="img-circle img-inline userpic-32" width="28" />
							<span >
								<p id="loginNameSpan">XJL BACK</p>
								<i class="fa-angle-down"></i>
							</span>
						</a>
						
						<ul class="dropdown-menu user-profile-menu list-unstyled">
							<li>
								<a id="userInfo" href="#edit-profile">
									<i class="fa-user"></i>
									个人信息维护
								</a>
							</li>
							<li>
								<a id="userPwd" href="#settings">
									<i class="fa-wrench"></i>
									修改密码
								</a>
							</li>
							<li>
								<a href="#help">
									<i class="fa-info"></i>
									帮助
								</a>
							</li>
							<li class="last">
								<a href="javascript:loginOut()">
									<i class="fa-lock"></i>
									退出
								</a>
							</li>
						</ul>
					</li>
				</ul>
			</nav>
			<!-- 主界面 -->
			<div class="row">
			 	<div class="embed-responsive embed-responsive-16by9">  
            			<iframe id="mainIframe" class="embed-responsive-item" src=""></iframe>  
        			</div> 
				<!-- <div class="embed-responsive embed-responsive-4by3">  
			            <embed class="embed-responsive-item" src="http://player.youku.com/player.php/sid/XMTI3NjI2MzQ2MA==/v.swf"  
			                   quality="high" width="350" height="240" align="middle" allowScriptAccess="always" allowFullScreen="true"  
			                   mode="transparent" type="application/x-shockwave-flash">  
			            </embed>  
       			 </div>   -->
			</div>
			<!-- Main Footer -->
			<!-- Choose between footer styles: "footer-type-1" or "footer-type-2" -->
			<!-- Add class "sticky" to  always stick the footer to the end of page (if page contents is small) -->
			<!-- Or class "fixed" to  always fix the footer to the end of page -->
			<footer class="main-footer sticky footer-type-1">
				<div class="footer-inner">
					<!-- Add your copyright text here -->
					<div class="footer-text">
						&copy; 2017 
						<strong>XJL</strong> 
						theme by <a href="#" target="_blank">Laborator</a>
					</div>
					<!-- Go to Top Link, just add rel="go-top" to any link to add this functionality -->
					<div class="go-up">
						<a href="#" rel="go-top">
							<i class="fa-angle-up"></i>
						</a>
					</div>
				</div>
			</footer>
		</div>
	</div>
	<!-- 用户空间 信息维护 start-->
		<!-- 模态框（Modal） -->
		<div class="modal fade" id="userInfoModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog">
			<div id="userInfoAlert" class="alert alert-warning" style="display: none;">
				<a href="#" class="close" data-dismiss="alert">&times;</a>
			</div>
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
							&times;
						</button>
						<h4 class="modal-title" id="myModalLabel">
							个人信息维护
						</h4>
					</div>
					<div class="modal-body">
						  <div class="form-group">
						  		<label  for="inputfile">姓名：</label>
						  		<label id="username"></label>
						  </div>
						  <div class="form-group">
						  		<label  for="inputfile">身份证号：</label>
						  		<label id="cardno"></label>
						  </div>
						  <div class="form-group">
						  		<label  for="inputfile">电话：</label>
						  		<label id="iphoneno"></label>
						  		<input id="newiphone" type="hidden"/>
						  		<button id="iphoneBtn" type="button" class="btn   btn-xs" style="margin-left: 5%">修改</button>
						  </div>
						  <div class="form-group">
						  		<label  for="inputfile">邮箱：</label>
						  		<label id="emailUpdate" ><input id="email" type="text" class="form-control"style="width:150%"  value=""></label>
						  </div>
						  <div class="form-group">
						  		<label  for="inputfile">地址：</label>
			  		 			<label id="addUpdate" ><input  id="address" type="text" class="form-control" style="width:150%" id="name"  value=""></label>
						  </div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">关闭 </button>
						<button id="userInfoSubmit" type="button" class="btn btn-primary"> 提交更改 </button>
					</div>
				</div><!-- /.modal-content -->
			</div><!-- /.modal -->
		</div>
		<!-- 绑定手机 -->
		<div class="modal fade" id="setIphone" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog">
			 <div id="userPhoneAlert" class="alert alert-warning" style="display: none;">
				<a href="#" class="close" data-dismiss="alert">&times;</a>
			</div>
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
							&times;
						</button>
						<h4 class="modal-title" id="myModalLabel">
							更换手机号<font color="red"style="font-size:12px;">(注意：验证码会发送到之前绑定手机号)</font>
						</h4>
					</div>
					<div class="modal-body">
					 	  <div class="form-group">
								<label  for="inputfile">手机号：</label>
						  		<label id="oldiphone"></label>
						  		<button id="sendCode" type="button" class="btn   btn-xs" style="margin-left: 9%">发送验证码</button>
						  </div>
						  <div class="form-group">
						  		<label  for="inputfile">输入验证码：</label>
						  		<label><input id="code" type="text" class="form-control"style="width:100%" ></label>
						  </div>
						  <div class="form-group">
						  		<label  for="inputfile">绑定新号码：</label>
						  		<label><input id="newIphone" type="text" class="form-control"style="width:100%" ></label>
						  </div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">关闭 </button>
						<button id="iphoneSubmit" type="button" class="btn btn-primary"> 提交更改 </button>
					</div>
				</div><!-- /.modal-content -->
			</div><!-- /.modal -->
		</div>
		<!-- 修改密码-->
	<div class="modal fade" id="userPwdModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
		 <div id="userPwdAlert" class="alert alert-warning" style="display: none;">
			<a href="#" class="close" data-dismiss="alert">&times;</a>
		</div>
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
						&times;
					</button>
					<h4 class="modal-title" id="myModalLabel">
						修改登录密码
					</h4>
				</div>
				<div id="'pwd_body" class="modal-body">
					  <div class="form-group">
								<label  for="inputfile">手机号：</label>
						  		<label id="userPwdPhone"></label>
						  		<button id="sendCodePwd" type="button" class="btn   btn-xs" style="margin-left: 9%">发送验证码</button>
						 </div>
					  <div class="form-group">
						  		<label  for="inputfile">输入验证码：</label>
						  		<label><input id="code_pwd" name="code_pwd" type="text" class="form-control"style="width:100%" ></label>
					  </div>
					  <div class="form-group">
						  		<label  for="inputfile">输入新密码：</label>
						  		<label><input id="password" type="password" class="form-control"style="width:100%" ></label>
					  </div>
					  <div class="form-group">
						  		<label  for="inputfile">确认新密码：</label>
						  		<label><input id="reppwd" type="password" class="form-control"style="width:100%" ></label>
					  </div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">关闭 </button>
					<button id="pwdSubmit" type="button" class="btn btn-primary"> 提交更改 </button>
				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal -->
	</div>
	<!-- 用户空间 信息维护 end -->
	<script src="../js/assets/js/jquery-1.11.1.min.js"></script>
	<script src="../js/jquery/js/jquery-rest.js"></script>
	<script src="../js/bootstrapvalidator/js/bootstrapValidator.js"></script>
	<!-- Bottom Scripts -->
	<script src="../js/assets/js/bootstrap.min.js"></script>
	<script src="../js/assets/js/TweenMax.min.js"></script>
	<script src="../js/assets/js/resizeable.js"></script>
	<script src="../js/assets/js/joinable.js"></script>
	<script src="../js/assets/js/xenon-api.js"></script>
	<script src="../js/assets/js/xenon-toggles.js"></script>
	<!-- Imported scripts on this page -->
	<script src="../js/assets/js/xenon-widgets.js"></script>
	<script src="../js/assets/js/devexpress-web-14.1/js/globalize.min.js"></script>
	<script src="../js/assets/js/devexpress-web-14.1/js/dx.chartjs.js"></script>
	<script src="../js/assets/js/toastr/toastr.min.js"></script>
	<!-- JavaScripts initializations and stuff -->
	<script src="../js/assets/js/xenon-custom.js"></script>
	<script src="../js/xjl/js/custom.js"></script>
	<script type="text/javascript">
		/*初始化*/
		var userId;
		var iphoneNo;
		var sendCode="";
		$(function(){
			/*展示登录用户*/
			var data={};
			$.restPost({
				 url:'../rest/user/showUser',
				 data:data,
				 success:function(data){
					if(data){
						userId = data.userId;
						$("#loginName").html(data.userName);
						$("#loginNameSpan").html(data.userName);
					}
				 }
			});
			/*弹出模式框*/
			$("#userInfo").click(function(){
				var data={"userId":userId};
				$.restPost({
					url:'../rest/user/queryUserInfo',
					data:data,
					success:function(data){
						if(data){
							if("" !=data.cardName){
								$("#username").html(data.cardName);
							}else{
								$("#username").html("<input id='userName' type='' class='form-control'style='width:150%' >")
							}
							if("" !=data.cardNo){
								$("#cardno").html(data.cardNo);
							}else{
								$("#cardno").html("<input id='cardNo' type='' class='form-control'style='width:150%' >")
							}
							$("#iphoneno").html(data.phoneNo);
							iphoneNo = data.phoneNo;
							$('#userInfoModal').modal({
								keyboard: true
							})
						}
					}
				});
			});
			/*修改按钮*/
			$("#iphoneBtn").click(function(){
				$("#oldiphone").html(iphoneNo);
				$('#setIphone').modal({});
			});
			/*发送短信*/
			$("#sendCode").click(function(){
				var data={"phoneno":iphoneNo};
				$.restPost({
					 url:'../rest/user/sendMsg',
					 data:data,
					 success:function(data){
						 if(data.success){
							 $("#userPhoneAlert").attr("class","alert alert-success");
							 showCustomMsg('userPhoneAlert',"成功","短信息发送成功");
							 sendCode = data.showMsg;
						 }else{
							 $("#userPhoneAlert").attr("class","alert alert-warning");
							 showCustomMsg('userPhoneAlert',"警告","短信息发送失败");
						 }
					 }
				});
			});
			/*提交手机号*/
			$("#iphoneSubmit").click(function(){
				var code = $("#code").val();
				var iphoneNo = $("#newIphone").val();
				 $("#userPhoneAlert").attr("class","alert alert-warning");
				 if(code.length == 0){
						showCustomMsg('userPhoneAlert',"警告","请输入验证码");
						 return;
					}
				if(sendCode != code){
					showCustomMsg('userPhoneAlert',"警告","验证码输入失败");
					 return;
				}
				if(iphoneNo.length == 0){
					showCustomMsg('userPhoneAlert',"警告","请输入手机号码");
					 return;
				}
				if(iphoneNo.length<11){
					showCustomMsg('userPhoneAlert',"警告","请输入正确的手机号");
					return;
				} 
				if(iphoneNo.length>11){
					showCustomMsg('userPhoneAlert',"警告","请输入正确的手机号");
					return;
				} 
				$("#iphoneno").html(iphoneNo);
				$("#newiphone").val(iphoneNo);
				//增加验证码判断
				hideModel('setIphone');
			});
			/*提交用户信息*/
			$("#userInfoSubmit").click(function(){
				var data={"iphoneNo":$("#newiphone").val(),"userId":userId,"userName":$("#userName").val(),"cardNo":$("#cardNo").val()};
				$.restPost({
					 url:'../rest/user/modifyUserInfo',
					 data:data,
					 success:function(data){
						 if(data.success){
							 $("#userInfoAlert").attr("class","alert alert-success");
							 showCustomMsg('userInfoAlert',"成功","操作成功");
							 setTimeout("hideModel('userInfoModal')",3000);
						 }else{
							 $("#userInfoAlert").attr("class","alert alert-warning");
							 showCustomMsg('userInfoAlert',"警告","操作失败");
						 }
						 sendCode="";
					 }
				});
			});
			/*发送短信*/
			$("#sendCodePwd").click(function(){
				var data={"phoneno":iphoneNo};
				$.restPost({
					 url:'../rest/user/sendMsg',
					 data:data,
					 success:function(data){
						 if(data.success){
							 $("#userPwdModal").attr("class","alert alert-success");
							 showCustomMsg('userPwdModal',"成功","短信息发送成功");
							 sendCode = data.showMsg;
						 }else{
							 $("#userPwdModal").attr("class","alert alert-warning");
							 showCustomMsg('userPwdModal',"警告","短信息发送失败");
						 }
					 }
				});
			});
			
			/*修改密码*/
			$("#userPwd").click(function(){
				var data={"userId":userId};
				$.restPost({
					url:'../rest/user/queryUserInfo',
					data:data,
					success:function(data){
						if(data){
							iphoneNo = data.phoneNo;
							$("#userPwdPhone").html(data.phoneNo);
							$("#userPwdModal").modal({ })
						}
					}
				});
			});
			/*修改密码提交*/
			$("#pwdSubmit").click(function(){
				var code_pwd = $("#code_pwd").val();
				var password = $("#password").val();
				var reppwd = $("#reppwd").val();
				 $("#userPwdAlert").attr("class","alert alert-warning");
			     if(code_pwd.length == 0){
					 showCustomMsg('userPwdAlert',"警告","请输入验证码");
					 return;
				 }
				if(sendCode != code_pwd){
					 showCustomMsg('userPwdAlert',"警告","验证码输入错误");
					 return;
				}
				if(password.length == 0){
					 showCustomMsg('userPwdAlert',"警告","请输入密码");
					 return;
				}
				if(reppwd.length == 0){
					 showCustomMsg('userPwdAlert',"警告","请输入确认密码");
					 return;
				}
				if(password != reppwd){
					 showCustomMsg('userPwdAlert',"警告","两次密码输入不符");
					 return;
				} 
				var data={"phoneNo":iphoneNo,"password":password};
				$.restPost({
					 url:'../rest/user/updatePwd',
					 data:data,
					 success:function(data){
						 if(data.success){
							 //登录成功跳转
							  $("#myAlert").attr("class","alert alert-success");
							  showCustomMsg('userPwdAlert',"提示","密码修改成功!");
							 setTimeout("hideModel('userPwdModal')",3000);
						 }else{
							 $("#myAlert").attr("class","alert alert-warning");
							 showCustomMsg('userPwdAlert',"警告","密码修改失败");
						 }
					 }
				}); 
			});
		});
		/*隐藏魔术框*/
		function hideModel(id){
			$('#'+id).modal('hide');
		}
		/*简单的切换嵌入页面*/
		function switchModel(url,id){
			$("#mainIframe").attr("src",url);
			$("#"+id).addClass("active");
		}
		/*退出*/
		function loginOut(){
			var data={};
			$.restPost({
				 url:'../rest/user/loginOut',
				 data:data,
				 success:function(data){
					 if(data.success){
						 window.location.href="../login/login.html";
					 }else{
					 }
				 }
			});
		}
	</script>
</body>
</html>